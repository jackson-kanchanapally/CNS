<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Diffie-Hellman Key Exchange</title>
  </head>
  <body>
    <h1>Diffie-Hellman Key Exchange</h1>
    <label for="prime">p (Prime Number):</label>
    <input type="number" id="prime" />
    <br /><br />
    <label for="base">g (Primitive Root):</label>
    <input type="number" id="base" />
    <br /><br />
    <label for="privateKeyAlice">Alice's Private Key:</label>
    <input type="number" id="privateKeyAlice" />
    <br /><br />
    <label for="privateKeyBob">Bob's Private Key:</label>
    <input type="number" id="privateKeyBob" />
    <br /><br />
    <button onclick="calculateAndExchangeKeys()">
      Generate Keys & Exchange
    </button>
    <br /><br />
    <p>Alice's Public Key: <span id="publicKeyAlice"></span></p>
    <p>Bob's Public Key: <span id="publicKeyBob"></span></p>
    <br /><br />
    <p>Alice's Shared Secret: <span id="sharedSecretAlice"></span></p>
    <p>Bob's Shared Secret: <span id="sharedSecretBob"></span></p>
    <script>
      function calculateAndExchangeKeys() {
        const prime = parseInt(document.getElementById("prime").value);
        const base = parseInt(document.getElementById("base").value);
        const privateKeyAlice = parseInt(
          document.getElementById("privateKeyAlice").value
        );
        const privateKeyBob = parseInt(
          document.getElementById("privateKeyBob").value
        );

        const publicKeyAlice = Math.pow(base, privateKeyAlice) % prime;
        const publicKeyBob = Math.pow(base, privateKeyBob) % prime;

        document.getElementById("publicKeyAlice").textContent = publicKeyAlice;
        document.getElementById("publicKeyBob").textContent = publicKeyBob;

        const sharedSecretAlice =
          Math.pow(publicKeyBob, privateKeyAlice) % prime;
        const sharedSecretBob = Math.pow(publicKeyAlice, privateKeyBob) % prime;

        document.getElementById("sharedSecretAlice").textContent =
          sharedSecretAlice;
        document.getElementById("sharedSecretBob").textContent =
          sharedSecretBob;
      }
    </script>
  </body>
</html>
